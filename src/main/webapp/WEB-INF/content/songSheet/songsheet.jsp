<%@page contentType="text/html"%>
<%@page pageEncoding="UTF-8"%>
<%@ page isELIgnored="false"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="f"%>
<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<meta name="baidu-site-verification" content="cNhJHKEzsD">
<meta property="qc:admins" content="27354635321361636375">
<link rel="canonical"
	href="https://music.163.com/playlist?id=2144082923">
<meta name="applicable-device" content="pc">
<link rel="alternate" media="only screen and (max-width: 640px)"
	href="https://music.163.com/m/playlist?id=2144082923">
<link rel="stylesheet" type="text/css"
	href="${pageContext.request.contextPath}/resources/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css"
	href="${pageContext.request.contextPath}/resources/css/docResult.css" />
<meta name="mobile-agent"
	content="format=html5;url=https://music.163.com/m/playlist?id=2144082923">
<title>哼首欢快的歌 来拯救你的小确丧 - 歌单 - 网易云音乐</title>
<meta name="keywords" content="哼首欢快的歌 来拯救你的小确丧，鹿白川，华语，放松，快乐">
<meta property="og:title" content="哼首欢快的歌 来拯救你的小确丧 - 歌单 - 网易云音乐">
<meta property="og:type" content="music.playlist">
<meta property="og:image"
	content="http://p1.music.126.net/SjJfSQqlLgqXfZAI2A3YNA==/19091919905258248.jpg">
<meta property="og:url"
	content="https://music.163.com/playlist?id=2144082923">
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
<script
	src="${pageContext.request.contextPath}/resources/js/jquery.min.js"
	type="text/javascript" charset="utf-8"></script>
<script
	src="${pageContext.request.contextPath}/resources/js/bootstrap.min.js"
	type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" async="" src="//wr.da.netease.com/ga.js"></script>

<script type="application/ld+json">
			{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "http://music.163.com/playlist?id=2144082923",
				"appid": "1582028769404989",
				"title": "哼首欢快的歌 来拯救你的小确丧",
				"images": ["http://p1.music.126.net/SjJfSQqlLgqXfZAI2A3YNA==/19091919905258248.jpg"],
				"description": "/ 音 / 乐 / 是 / 心 / 情 / 的 / 催 / 化 / 剂 /\n\n怎么了\n又不开心了\n没关系\n哼首欢快的歌来拯救你的小确丧\n你并不孤单\n看 我一直陪着你啊\n周围的空气都莫名变得好甜\n这个世界 还是很美好的\n\n为歌单《以丧止丧 听",
				"pubDate": "2018-03-17T10:06:32"
			}
</script>
<link rel="shortcut icon"
	href="//s1.music.126.net/style/favicon.ico?v20180823">
<link
	href="//s2.music.126.net/web/s/core_c464156eac837ff361441d7da9704d6d.css?c464156eac837ff361441d7da9704d6d"
	type="text/css" rel="stylesheet">
<link
	href="//s2.music.126.net/web/s/pt_frame_5d04cf4bb51391164efd9d7fec6f9bdc.css?5d04cf4bb51391164efd9d7fec6f9bdc"
	type="text/css" rel="stylesheet">
<script type="text/javascript" charset="UTF-8" async=""
	src="https://acstatic-dun.126.net/2.3.1_ce5a6dcf/watchman.min.js"></script>
<style type="text/css">
.auto-1536570832327 {
	position: fixed;
	_position: absolute;
	z-index: 100;
	top: 0;
	bottom: 0;
	left: 0;
	right: 0;
	width: 100%;
	height: 100%;
	background-image:
		url(data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==);
}

.auto-1536570832328 {
	position: absolute;
	z-index: 1000;
	border: 1px solid #aaa;
	background: #fff;
}

.auto-1536570832328 .zbar {
	line-height: 30px;
	background: #8098E7;
	border-bottom: 1px solid #aaa;
}

.auto-1536570832328 .zcnt {
	padding: 10px 5px;
}

.auto-1536570832328 .zttl {
	margin-right: 20px;
	text-align: left;
}

.auto-1536570832328 .zcls {
	position: absolute;
	top: 5px;
	right: 0;
	width: 20px;
	height: 20px;
	line-height: 20px;
	cursor: pointer;
}

.auto-1536570832329 {
	position: absolute;
	background: #fff;
}

.auto-1536570832330 {
	font-size: 12px;
	line-height: 160%;
}

.auto-1536570832330 a {
	margin: 0 2px;
	padding: 2px 8px;
	color: #333;
	border: 1px solid #aaa;
	text-decoration: none;
}

.auto-1536570832330 .js-disabled {
	cursor: default;
}

.auto-1536570832330 .js-selected {
	cursor: default;
	background: #bbb;
}

.j-item.j-selected a {
	background: #eee;
	text-decoration: none;
	color: #333;
}

.u-atlist {
	position: absolute;
	z-index: 10000;
}

.f-thide.selected-item {
	background-color: #eee;
}

#shadow-box {
	position: absolute;
	display: block;
	left: 450px;
	top: 1020px;
	border: 1px solid black;
	word-wrap: break-word;
	display: none;
	opacity: 0;
	filter: Alpha(opacity = 0);
	z-index: -1000;
}
</style>
</head>
<style type="text/css" id="14139293375"></style>
<script>
	(function($) {
		function crateCommentInfo(obj) {

			if (typeof (obj.time) == "undefined" || obj.time == "") {
				obj.time = getNowDateFormat();
			}
			var el = "<div class='cmmts j-flag'><div id='' class='itm' data-id='1242923108'><div class='head'><a href='/user/home?id=1525516810'><img src='"+obj.img+"'></a></div>"
					+ "<div class='cntwrap'><div class=''><div class='cnt f-brk'><a href='#' class='s-fc7'>"
					+ obj.replyName
					+ "</a>："
					+ obj.content
					+ "</div></div>"
					+ "<div class='rp'><div class='time s-fc4'>"
					+ obj.time
					+ "</div><span class='dlt'>"
					+ "<a href='javascript:void(0)' class='del' data-id='1242923108' data-type='delete'>删除</a><span class='sep'>|</span></span>"
					+ "<a data-id='1242923108' data-type='like' href='javascript:void(0)'><i class='zan u-icn2 u-icn2-12'></i></a><span class='sep'>|</span><a href='javascript:void(0)' class='s-fc3 reply-btn' data-id='1242923108' data-type='reply'>回复</a></div></div></div><div><div class='reply-list'>";

			if (obj.replyBody != "" && obj.replyBody.length > 0) {
				var arr = obj.replyBody;
				for (var j = 0; j < arr.length; j++) {
					var replyObj = arr[j];
					el = el + createReplyComment(replyObj);
				}
			}
			el = el + "</div></div></div>";
			return el;
		}

		//返回每个回复体内容
		function createReplyComment(reply) {
			var replyEl = "<div class='reply que f-brk f-pr s-fc3'><div><a href='javascript:void(0)' class='replyname s-fc7'>"
					+ reply.replyName
					+ "</a>:<a href='javascript:void(0)' class='s-fc7'>@"
					+ reply.beReplyName
					+ "</a><span>"
					+ reply.content
					+ "</span></div>"
					+ "<p style='padding-top:10px;'><span>"
					+ reply.time
					+ "</span> <a class='reply-list-btn' style='float:right;'>回复</a></p></div>";
			return replyEl;
		}

		/*function createReplyComment(reply){
			var replyEl = "<div class='reply que f-brk f-pr s-fc3'><div><a href='javascript:void(0)' class='replyname'>"+reply.replyName+"</a>:<a href='javascript:void(0)' class='s-fc7'>@"+reply.beReplyName+"</a><span>"+reply.content+"</span></div>"
							+ "<p style='padding-top:10px;'><span>"+reply.time+"</span> <a class='reply-list-btn' style='float:right;'>回复</a></p></div>";
			return replyEl;
		}*/

		function getNowDateFormat() {
			var nowDate = new Date();
			var year = nowDate.getFullYear();
			var month = filterNum(nowDate.getMonth() + 1);
			var day = filterNum(nowDate.getDate());
			var hours = filterNum(nowDate.getHours());
			var min = filterNum(nowDate.getMinutes());
			var seconds = filterNum(nowDate.getSeconds());
			return year + "-" + month + "-" + day + " " + hours + ":" + min
					+ ":" + seconds;
		}
		function filterNum(num) {
			if (num < 10) {
				return "0" + num;
			} else {
				return num;
			}
		}
		function replyClick(el) {
			el
					.parent()
					.parent()
					.append(
							"<div class='replybox'><textarea cols='80' rows='3' placeholder='评论......' class='mytextarea' ></textarea><span class='send btn u-btn u-btn-1 j-flag' style='position: absolute;'>发送</span></div>")
					.find(".send")
					.click(
							function() {
								var content = $(this).prev().val();
								if (content != "") {
									var parentEl = $(this).parent().parent()
											.parent().parent();
									var obj = new Object();
									obj.replyName = "";
									if (el.parent().parent().hasClass("reply")) {
										obj.beReplyName = el.parent().parent()
												.find("a:first").text();
									} else {
										obj.beReplyName = parentEl.find("h3")
												.text();
									}
									obj.content = content;
									obj.time = getNowDateFormat();
									var replyString = createReplyComment(obj);
									$(".replybox").remove();
									parentEl.find(".reply-list").append(
											replyString).find(
											".reply-list-btn:last").click(
											function() {
												alert("不能回复自己");
											});
								} else {
									alert("空内容");
								}
							});
		}

		$.fn.addCommentList = function(options) {
			var defaults = {
				data : [],
				add : ""
			}
			var option = $.extend(defaults, options);
			//加载数据
			if (option.data.length > 0) {
				var dataList = option.data;
				var totalString = "";
				for (var i = 0; i < dataList.length; i++) {
					var obj = dataList[i];
					var objString = crateCommentInfo(obj);
					totalString = totalString + objString;
				}
				$(this).append(totalString).find(".reply-btn")
						.click(
								function() {
									if ($(this).parent().parent().find(
											".replybox").length > 0) {
										$(".replybox").remove();
									} else {
										$(".replybox").remove();
										replyClick($(this));
									}
								});
				$(".reply-list-btn")
						.click(
								function() {
									if ($(this).parent().parent().find(
											".replybox").length > 0) {
										$(".replybox").remove();
									} else {
										$(".replybox").remove();
										replyClick($(this));
									}
								})
			}

			//添加新数据
			if (option.add != "") {
				obj = option.add;
				var str = crateCommentInfo(obj);
				$(this).prepend(str).find(".reply-btn").click(function() {
					replyClick($(this));
				});
			}
		}
	})(jQuery);
</script>

<body id="auto-id-SfAiwBWwMMiJUV6c" class="auto-1536570832333-parent">
		<%@ include file="/WEB-INF/content/public/head.jspf"%>
	<div id="m-playlist" class="g-bd4 f-cb" style="">
		<div class="g-mn4">
			<div class="g-mn4c">
				<div class="g-wrap6">
					<div class="m-info f-cb" id="auto-id-tR4Gag7tgCnnfwP">
						<div class="cover u-cover u-cover-dj">
							<img
								src="${pageContext.request.contextPath}/resources/img/${songSheet.img}"
								class="j-img">
						</div>
						<div class="cnt">
							<div class="cntc">
								<div class="hd f-cb">
									<i class="f-fl u-icn2 u-icn2-jp1"></i>
									<div class="tit tit3">
										<h2 class="f-ff2 f-brk">${songSheet.title}</h2>
									</div>
								</div>
								<!-- 标签 -->
								<div class="tags f-cb">
									<b>标签：</b>
									<c:forEach items="${tags}" var="tag">
										<a class="u-tag" href=""><i>${tag} </i></a>
									</c:forEach>
								</div>
								<p id="album-desc-dot" class="intr f-brk">
									<b>介绍：</b>${songSheet.title}<br> <br>
								</p>
							</div>
						</div>
					</div>
					<div class="n-songtb">
						<div class="u-title u-title-1 f-cb">
							<h3>
								<span class="f-ff2">歌曲列表</span>
							</h3>
							<span class="sub s-fc3"><span id="playlist-track-count">${size}</span>首歌</span>
						</div>
						<div id="song-list-pre-cache" data-key="track_playlist-2144082923"
							data-simple="1" data-pvnamed="1">
							<div oncopy="return false;" oncut="return false;"
								ondragstart="return false;" id="auto-id-2f3IrCGhTwhNoCL5">
								<div class="j-flag" id="auto-id-Ol5WpSmJI094chb4">
									<table class="m-table ">
										<thead>
											<tr>
												<th class="first w1">
													<div class="wp">&nbsp;</div>
												</th>
												<th>
													<div class="wp af0"></div>
												</th>
												<th class="w2">
													<div class="wp af1"></div>
												</th>
												<th class="w3">
													<div class="wp af2"></div>
												</th>
												<th class="w4">
													<div class="wp af3"></div>
												</th>
											</tr>
										</thead>
										<!-- 音乐 -->
										<tbody>
											<c:forEach items="${musicList}" var="music"
												varStatus="status">
												<tr id="3688441536570832328" class="even ">
													<td class="left">
														<div class="hd ">
															<span data-res-id="368844" data-res-type="18"
																data-res-action="play" data-res-from="13"
																data-res-data="2144082923" class="ply ">&nbsp;</span><span
																class="num">${status.index+1}</span>
														</div>
													</td>
													<td class="">
														<div class="f-cb">
															<div class="tt">
																<div class="ttc">
																	<span class="txt"><a
																		href="${pageContext.request.contextPath}/music/song?musicId=${music.musicId}">
																			<b title="${music.musicName}">${music.musicName}</b>
																	</a></span>
																</div>
															</div>
														</div>
													</td>
													<td class=" s-fc3"><span class="u-dur ">${music.musicTime}</span>
														<div class="opt hshow">
														<c:choose>
														<c:when test="${empty user }">
														<a class="u-icn u-icn-81 icn-add" onclick="top.login();return false;"
																title="添加到播放列表" ></a> 
															
															</c:when>
														<c:otherwise>
															<a class="u-icn u-icn-81 icn-add" href="${pageContext.request.contextPath}/json/addloveMusics?userId=${user.userId}&musicId=${music.musicId}"
																title="添加到播放列表" ></a> 
														</c:otherwise>
													</c:choose><span
																class="icn icn-fav" title="收藏">
															</span><span class="icn icn-share" title="分享">分享</span>
															<span class="icn icn-dl" title="下载"></span>
														</div></td>
													<td class="">
														<div class="text" title="${music.singer.singerName}">
															<span title="${music.singer.singerName}"><a
																class=""
																href="${pageContext.request.contextPath}/singer/findSinger?singerId=${music.singer.singerId}"
																hidefocus="true"> ${music.singer.singerName} </a></span>
														</div>
													</td>
													<td class="">
														<div class="text">
															<a
																href="${pageContext.request.contextPath}/album/albumInfo?albumId=${music.album.albumId}"
																title=" ${music.album.albumName}">
																${music.album.albumName} </a>
														</div>
													</td>
												</tr>
											</c:forEach>
										</tbody>
									</table>
								</div>
								<div class="j-flag"></div>
							</div>
						</div>
					</div>
					<div class="n-cmt" id="comment-box" data-tid="A_PL_0_2144082923"
						data-count="698" data-uid="493707309">
						<div id="auto-id-VkMVDpBAdLg7kkcw">
							<div class="u-title u-title-1">
								<h3>
									<span class="f-ff2">评论</span>
								</h3>
								<span class="sub s-fc3">共<span class="j-flag">${commentListSize}</span>条评论
								</span>
							</div>
							<div class="m-cmmt">
								<div class="iptarea">
									<div class="head">
										<c:choose>
											<c:when test="${empty  userInfo}">
												<img
													src="${pageContext.request.contextPath}/resources/img/default_avatar.jpg">
											</c:when>
											<c:otherwise>
												<img
													src="${pageContext.request.contextPath}/resources/img/user/${userInfo.userImg}">
											</c:otherwise>
										</c:choose>
									</div>
									<div class="j-flag">
										<div>
											<div class="m-cmmtipt f-cb f-pr">
												<div class="u-txtwrap holder-parent f-pr"
													style="display: block;">
													<textarea class="u-txt area j-flag" data-type="0"
														id="userComment" placeholder="评论"
														id="auto-id-G31UuXSqwzIGuHQL"></textarea>
												</div>

												<div class="btns f-cb f-pr comment-box">
													<c:choose>
														<c:when test="${empty user }">
															<a onclick="top.login();return false;"
																class=""
																id="auto-id-ADAf4RywDJo14GLL">评论</a>

														</c:when>
														<c:otherwise>
															<a onclick="replyCommentp(this)"
																class=""
																id="auto-id-ADAf4RywDJo14GLL">评论</a>
														</c:otherwise>
													</c:choose>
													<ul class="list-group">
														<li class="list-group-item"><b></b></li>

														<!-- 插入这之前 -->
														<li class="list-group-item" id="getMore">
													</ul>

												</div>
												<div class="corr u-arr">
													<em class="arrline">◆</em><span class="arrclr">◆</span>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>


	<script>
		function replyCommentp(mythis) {
			var comment = $("#userComment").val();
			var pId = null;
			$
					.post(
							"${pageContext.request.contextPath}/json/json-add-songsheet-comments",
							{
								"userId" : "${userInfo.userId}",
								"commentContent" : comment, /* 获得内容   */
								"parentId" : pId,
								"sid" : "${songSheet.sid}"
							},
							function(json) { //返回数据  先判断是什么类型  
								var insertSr = "<li class='list-group-item'>"
										+ "<div class='panel panel-default'>"
										+ "<ul class='list-group'>"
										+ "<li class='list-group-item'><img src='${pageContext.request.contextPath}/resources/img/user/"+json.commentUser.userImg+"'   class='small-photo'><b>"
										+ json.commentUser.userName
										+ "：</b> "
										+ json.commentTime
										+ json.commentContent
										+ "</li>"
										+ "<li class='list-group-item commonent-child'><button class='reply-btn' onclick='replyComment(this,"
										+ json.commentId
										+ ")'>回复</button></li>" + "</ul>"
										+ "</div>" + "</li>";
								/* 在第一个li之后插入  */
								$(insertSr).insertAfter(
										$(".comment-box").eq(0).find("li")
												.eq(0));

							})
		}
		/* 点击回复  评论区  */
		var editor_str = "<form class='reply'><textarea class=" + "'form-control'" + "rows=" + "'3'" + "placeholder=" + "评论.." + "></textarea><br></form>";
	
		
		/*    点击回复      参数pid为父评论id      */
		function replyComment(mythis, pId) {
			var $p = $(mythis).parent(); //找到li的 父ul
			if ($p.has("form").length > 0) { //回复信息   form 找到评论区form
				$
						.post(
								"${pageContext.request.contextPath}/json/json-add-songsheet-comments",
								{
									"userId" : "${userInfo.userId}",
									"commentContent" : $p.find("textarea").val(),
									"sid" : "${songSheet.sid}",
									"parentId" : pId
								},
								function(json) {
									var replyStr = "<li class='list-group-item commonent-child'><img src='${pageContext.request.contextPath}/resources/img/user/"+json.commentUser.userImg+"' class='small-photo'> <b>"
											+ json.commentUser.userName
											+ ":</b>"
											+ json.commentTime
											+ "<p>"
											+ json.commentContent
											+ "</p>" + "<p></li>";
									//插入之前
									$(replyStr).insertBefore(
											$p.parent().find("li").last());
									$p.find("textarea").val("");
								})
			} else {
				alert("增加评论框");
				//移去回复按钮
				$(".comment-box").find(".reply").remove();
				//  点击回复    增加评论框
				$p.prepend(editor_str);
			}
		}

		//加载评论
		function getMoreInfo() {
			var uri = "${pageContext.request.contextPath}/json/json-songsheet-comments?sid=" + ${songSheet.sid};
			$
					.post(
							uri,
							function(json) {
								//alert(JSON.stringify(json));
							
								if (null != json && "" != json) {
									//验证是否解析正确
									if (json == null || json == '') {
										$("#getMore").remove();
									}
									for (var i = 0; i < json.length; i++) {
										var cstr = "";
										for (j = 0; j < json[i].childrenComment.length; j++) {
											cstr += "<li class='list-group-item commonent-child'><img src='${pageContext.request.contextPath}/resources/img/user/"+json[i].childrenComment[j].commentUser.userImg+"' class='small-photo'><b>"
													+ json[i].childrenComment[j].commentUser.userName
													+ "：</b>"
													+ json[i].childrenComment[j].commentTime
													+ "<p>"
													+ json[i].childrenComment[j].commentContent
													+ "</p>" + "</li>";
										}
										var insertSr = "<li class='list-group-item'>"
												+ "<div class='panel panel-default'>"
												+ "<ul class='list-group'>"
												+ "<li class='list-group-item'><img src='${pageContext.request.contextPath}/resources/img/user/"+json[i].commentUser.userImg+"' class='small-photo'> <b>"
												+ json[i].commentUser.userName
												+ "：</b>"
												+ json[i].commentTime
												+ "<p>"
												+ json[i].commentContent
												+ "</p>"
												+ "</li>"
												+ cstr
												+ "<li class='list-group-item commonent-child'><button class='reply-btn' onclick='replyComment(this"
												+ ","
												+ json[i].commentId
												+ ")'>回复</button></li>"
												+ "</ul>" + "</div>" + "</li>";
										//父评论框插在 getMore之前
										$(insertSr).insertBefore($("#getMore"));
									}
									
								}
							})
			pageNum++;

		}
		$(function() {
			//评论页
			var pageNum = 0;
			getMoreInfo();
		});
	</script>

</body>
</html>